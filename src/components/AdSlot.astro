---
const {
  name,
  minHeight = 120,
  minWidth,
}: {
  name: string;
  minHeight?: number;
  minWidth?: number;
} = Astro.props;

import { ADSENSE_ENABLED, ADSENSE_MODE } from '../lib/adsense';

const ADS_ENABLED = ADSENSE_ENABLED;
---

<div
  class="adSlot"
  data-slot={name}
  style={{
    minHeight: `${minHeight}px`,
    ...(minWidth ? { minWidth: `${minWidth}px` } : {}),
  }}
>
  {ADS_ENABLED ? (
    <div class="adSlotInner">
      {/* Google AdSense placeholder: fill in data-ad-slot values when available. */}
      <ins
        class="adsbygoogle"
        style="display:block"
        data-ad-client={import.meta.env.PUBLIC_ADSENSE_CLIENT}
        data-ad-slot={import.meta.env[`PUBLIC_ADSENSE_SLOT_${name.toUpperCase()}`]}
        data-ad-format="auto"
        data-full-width-responsive="true"
        data-npa={ADSENSE_MODE === 'non-personalized' ? '1' : undefined}
      ></ins>
      <script>
        {`(adsbygoogle = window.adsbygoogle || []).push({});`}
      </script>
    </div>
  ) : (
    <div class="adSlotInner adSlotPlaceholder">
      <span>Ad slot: {name}</span>
    </div>
  )}
</div>
