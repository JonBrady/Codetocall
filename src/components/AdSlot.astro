---
import { ADSENSE_ENABLED, ADSENSE_MODE, ADS_RENDER } from '../lib/adsense';

const {
  name,
  minHeight = 120,
  minWidth,
}: {
  name: string;
  minHeight?: number;
  minWidth?: number;
} = Astro.props;

const ADS_ENABLED = ADSENSE_ENABLED && ADS_RENDER;

// If ads aren't meant to render yet, return nothing (no placeholder box, no reserved space).
if (!ADS_ENABLED) {
  return null;
}
---

<div
  class="adSlot"
  data-slot={name}
  style={{
    minHeight: `${minHeight}px`,
    ...(minWidth ? { minWidth: `${minWidth}px` } : {}),
  }}
>
  <div class="adSlotInner">
    <ins
      class="adsbygoogle"
      style="display:block"
      data-ad-client={import.meta.env.PUBLIC_ADSENSE_CLIENT}
      data-ad-slot={import.meta.env[`PUBLIC_ADSENSE_SLOT_${name.toUpperCase()}`]}
      data-ad-format="auto"
      data-full-width-responsive="true"
      data-npa={ADSENSE_MODE === 'non-personalized' ? '1' : undefined}
    ></ins>
    <script>
      {`(adsbygoogle = window.adsbygoogle || []).push({});`}
    </script>
  </div>
</div>
